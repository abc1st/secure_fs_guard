# Secure FS Guard

–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã —Å –∞–∫—Ç–∏–≤–Ω—ã–º –ø—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ–º –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üîí **–ö–æ–Ω—Ç—Ä–æ–ª—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏** ‚Äî –ø–æ–±–ª–æ—á–Ω–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (SHA-256, –±–ª–æ–∫–∏ 64 KB)
- üîÑ **–ê–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö
- üö® **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ ransomware** ‚Äî –∞–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –º–∞—Å—Å–æ–≤–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** ‚Äî inotify + fallback –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
- üíæ **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤
- üñ•Ô∏è **GUI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** ‚Äî —É–¥–æ–±–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ PySide6

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –î–µ–º–æ–Ω (root)
- `config_manager.py` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- `logger.py` ‚Äî –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `hash_storage.py` ‚Äî —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö —Ö—ç—à–µ–π (SQLite)
- `integrity_engine.py` ‚Äî –¥–≤–∏–∂–æ–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
- `watcher.py` ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤
- `recovery.py` ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
- `auth.py` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞–º–∏ —Ä–∞–±–æ—Ç—ã
- `ipc_server.py` ‚Äî IPC —Å–µ—Ä–≤–µ—Ä (UNIX socket)
- `main.py` ‚Äî –≥–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å

### GUI (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- `gui_main.py` ‚Äî –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
- `ipc_client.py` ‚Äî –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Å–≤—è–∑–∏ —Å –¥–µ–º–æ–Ω–æ–º
- `views/main_window.py` ‚Äî —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
- `views/settings_view.py` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `views/integrity_view.py` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤
- `views/logs_view.py` ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
sudo apt install python3 python3-pip inotify-tools

pip install -r requirements.txt
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
sudo mkdir -p /opt/secure_fs_guard
sudo cp -r daemon /opt/secure_fs_guard/
sudo cp -r gui /opt/secure_fs_guard/

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
sudo mkdir -p /etc/secure_fs_guard
sudo mkdir -p /var/lib/secure_fs_guard/storage/backups
sudo mkdir -p /var/log/secure_fs_guard

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤
sudo chmod 700 /var/lib/secure_fs_guard
sudo chmod 700 /var/log/secure_fs_guard
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω–∞
```bash
# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
sudo python3 /opt/secure_fs_guard/daemon/main.py

# –ò–ª–∏ —á–µ—Ä–µ–∑ systemd (—Å–º. scripts/install_service.sh)
sudo systemctl start secure-fs-guard
sudo systemctl enable secure-fs-guard
```

### –ó–∞–ø—É—Å–∫ GUI
```bash
python3 /opt/secure_fs_guard/gui/gui_main.py
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–§–∞–π–ª: `/etc/secure_fs_guard/system.yaml`
```yaml
protected_paths:
  - /home/*/Documents
  - /home/*/important_data

block_config:
  size: 65536  # 64 KB
  algorithm: sha256

ransomware_thresholds:
  files_count: 10
  time_window: 10
  block_change_percent: 70
  entropy_threshold: 7.5

monitoring:
  fallback_interval: 60
  use_inotify: true
```

## –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

1. **MONITOR** (–∫–æ–Ω—Ç—Ä–æ–ª—å) ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–∂–∏–º, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
2. **INIT** (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è) ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —ç—Ç–∞–ª–æ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
3. **UPDATE** (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ) ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
4. **EMERGENCY** (–∞–≤–∞—Ä–∏–π–Ω—ã–π) ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∞—Ç–∞–∫–∏

## –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

1. –î–µ–º–æ–Ω –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ–¥ root
2. –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —ç—Ç–∞–ª–æ–Ω–Ω—ã–µ —Ö—ç—à–∏
3. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤ (inotify + fallback)
4. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞:
   - –í—ã—á–∏—Å–ª—è—é—Ç—Å—è —Ç–µ–∫—É—â–∏–µ —Ö—ç—à–∏ –±–ª–æ–∫–æ–≤
   - –°—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏
   - –ü—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏ ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
5. –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ ransomware:
   - –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∞–≤–∞—Ä–∏–π–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
   - –ú–∞—Å—Å–æ–≤–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –î–µ–º–æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–¥ root
- –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ö—ç—à–µ–π: –ø—Ä–∞–≤–∞ 600
- IPC socket: –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏: –ø—Ä–∞–≤–∞ 600
- –õ–æ–≥–∏: –ø—Ä–∞–≤–∞ 600

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ë–∞–∫–∞–ª–∞–≤—Ä—Å–∫–∏–π –ø—Ä–æ–µ–∫—Ç